<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" xmlns:media="http://search.yahoo.com/mrss/"><channel><title>redis系列 on IBORA</title><link>https://ibora.evcoder.com/series/redis%E7%B3%BB%E5%88%97/</link><description>Recent content in redis系列 on IBORA</description><generator>Hugo -- gohugo.io</generator><language>zh</language><managingEditor>ender.viggin.coder@gmail.com (ender viggin)</managingEditor><webMaster>ender.viggin.coder@gmail.com (ender viggin)</webMaster><copyright>©2022, All Rights Reserved</copyright><lastBuildDate>Fri, 18 Feb 2022 16:50:51 +0800</lastBuildDate><atom:link href="https://ibora.evcoder.com/series/redis%E7%B3%BB%E5%88%97/index.xml" rel="self" type="application/rss+xml"/><item><title>【Redis】redis持久化机制</title><link>https://ibora.evcoder.com/posts/redisredis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6/</link><pubDate>Fri, 18 Feb 2022 16:50:51 +0800</pubDate><author>ender.viggin.coder@gmail.com (ender viggin)</author><atom:modified>Fri, 18 Feb 2022 16:50:51 +0800</atom:modified><guid>https://ibora.evcoder.com/posts/redisredis%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6/</guid><description>Redis作为一个键值对内存数据库，数据都存储在内存当中，在处理客户端请求时，所有操作都在内存当中进行。如果服务器关机或者Redis守护进程退出，内存中的数据就会消失。
对于只把Redis当缓存来用的项目来说，数据消失或许问题不大，重新从数据源把数据加载进来就可以了，但如果直接把用户提交的业务数据存储在Redis当中，把Redis作为数据库来使用，在其放存储重要业务数据，那么Redis的内存数据丢失所造成的影响也许是毁灭性。
Redis提供了RDB和AOF两种不同的数据持久化方式
RDB RDB是一种快照存储持久化方式，具体就是将Redis某一时刻的内存数据保存到硬盘的文件当中，默认保存的文件名为dump.rdb，而在Redis服务器启动时，会重新加载dump.rdb文件的数据到内存当中恢复数据。
save命令
当客户端向服务器发送save命令请求进行持久化时，服务器会阻塞save命令之后的其他客户端的请求，直到数据同步完成。
bgsave命令
当客户端发服务发出bgsave命令时，Redis服务器主进程会forks一个子进程来数据同步问题，在将数据保存到rdb文件之后，子进程会退出。主进程仍然可以接收其他请求，但forks子进程是同步的，所以forks子进程时，一样不能接收其他请求，这意味着，如果forks一个子进程花费的时间太久(一般是很快的)，bgsave命令仍然有阻塞其他客户的请求的情况发生。
配置文件触发
1 2 3 4 5 6 7 8 9 10 # redis.conf # 900s内至少达到一条写命令 save 900 1 # 300s内至少达至10条写命令 save 300 10 # 60s内至少达到10000条写命令 save 60 10000 # 启动服务器加载配置文件 redis-server redis.conf 达到触发条件时，会forks一个子进程进行数据同步，不过最好不要通过这方式来触发RDB持久化，因为设置触发的时间太短，则容易频繁写入rdb文件，影响服务器性能，时间设置太长则会造成数据丢失。
RDB文件 rdb文件的创建方式：生成临时rdb文件，并写入数据 &amp;gt; 完成数据写入，用临时文代替代正式rdb文件 &amp;gt; 删除原来的db文件
rdb配置文件：
1 2 3 4 5 6 # 是否压缩rdb文件 rdbcompression yes # rdb文件的名称 dbfilename redis-6379.</description><dc:creator>ender viggin</dc:creator><media:content url="https://ibora.evcoder.comhttps://image.evcoder.com/image/hugo/blog/redis-96.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>系列</category><category>Databases</category><category>redis系列</category></item><item><title>redis系列文章</title><link>https://ibora.evcoder.com/posts/%E7%B3%BB%E5%88%97redis%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/</link><pubDate>Wed, 09 Feb 2022 17:20:16 +0800</pubDate><author>ender.viggin.coder@gmail.com (ender viggin)</author><atom:modified>Wed, 09 Feb 2022 17:20:16 +0800</atom:modified><guid>https://ibora.evcoder.com/posts/%E7%B3%BB%E5%88%97redis%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/</guid><description>redis简介 Redis集群部署
helm部署redis集群 redis持久化机制</description><dc:creator>ender viggin</dc:creator><media:content url="https://ibora.evcoder.comhttps://image.evcoder.com/image/hugo/blog/redis-96.png" medium="image"><media:title type="html">featured image</media:title></media:content><category>系列</category><category>Databases</category><category>redis系列</category></item></channel></rss>